!function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);let a;try{a=JSON.parse(localStorage.getItem("toolbar-settings"))}catch(t){a={}}let o=Object.assign({showHiddenApps:!1},a);function i(t,e){console.info("set setting",t,e),o[t]=e,localStorage.setItem("toolbar-settings",JSON.stringify(o))}function s(t){return o[t]}o.showHiddenApps=!1,o.showTutorial=!1!==o.showTutorial;let l;function r(){q("#notification-panel").addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),async function(){await u,glue.agm.invoke("T42.Notifications.Show")}()}),l=!!q(".view-port.vertical"),q("#toggle .mode").innerHTML=l?"horizontal":"vertical",q("#toggle").addEventListener("click",()=>{q(".app").classList.add("switching-orientation"),l=!l,q("#toggle .mode").innerHTML=l?"horizontal":"vertical",q(".view-port").classList.add(l?"vertical":"horizontal"),q(".view-port").classList.remove(l?"horizontal":"vertical"),q(".app").classList.add(l?"d-inline-flex":"h"),q(".app").classList.remove(l?"h":"d-inline-flex"),qa("[column]").forEach(t=>{l?t.classList.add("flex-column"):t.classList.remove("flex-column")}),setTimeout(()=>{q(".app").classList.remove("switching-orientation")})}),function(){s("showTutorial")?q("#settings-content .show-tutorial").setAttribute("checked",!0):q("#settings-content .show-tutorial").removeAttribute("checked");q("#settings-content .show-tutorial").addEventListener("change",t=>i("showTutorial",t.srcElement.checked))}(),q(".theme-select").addEventListener("click",t=>{t.target.matches('input.select_input[type="radio"]')&&async function(t){glue.contexts.update("Connect.Themes",{selected:t})}(t.target.getAttribute("theme-name"))}),h.subscribe(t=>{if(t){t.all.forEach(t=>{q("html").classList.remove(t.name)}),q("html").classList.add(t.selected);let e="";t.all.forEach(n=>{e+=`<li class="select_option">\n          <input class="select_input" type="radio" name="theme" id="theme-${n.name}" theme-name="${n.name}" ${n.name===t.selected?"checked":""}/>\n          <label class="select_label" for="theme-${n.name}">${n.displayName}</label></li>`}),q(".theme-select .select_options").innerHTML=e}}),q("#open-about").addEventListener("click",()=>{let t=location.href.replace("#","").split("/").slice(0,-1);t.push("about.html"),t=t.join("/"),async function(t,e,n){await u;const a=glue.windows.my().bounds;n={...n,top:a.top+100,left:a.left+100},window.glue.windows.open(t,e,n)}("Glue42 About",t,{isSticky:!1,mode:"html",allowCollapse:!1,allowMaximize:!1,allowMinimize:!1,allowClose:!1,width:300,height:300})}),q("#shutdown").addEventListener("click",()=>{!async function(){await u,glue.appManager.exit()}()}),document.addEventListener("click",t=>{if(t.target.matches('[menu-button-id="apps"], [menu-button-id="apps"] *')&&t.altKey)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),i("showHiddenApps",!s("showHiddenApps")),void async function(){await u,v()}();if(t.target.matches("[menu-button-id], [menu-button-id] *")){let n=t.path.find(t=>t.getAttribute("menu-button-id")).getAttribute("menu-button-id");qa(`[menu-id]:not([menu-id="${n}"])`).forEach(t=>{t.classList.add("hide")}),qa(`[menu-id]:not([menu-button-id="${n}"]) .chavron`).forEach(t=>{t.classList.remove("chavron-rotate")});let a=q(`[menu-id="${n}"]`);a.addEventListener("transitionend",c),a.classList.toggle("hide"),e=n,qa(`[menu-button-id="${e}"] .chavron`).forEach(t=>t.classList.toggle("chavron-rotate")),qa(`[menu-button-id="${e}"] > a`).forEach(t=>t.classList.toggle("active")),qa(`[menu-button-id]:not([menu-button-id="${e}"]) .chavron`).forEach(t=>t.classList.remove("chavron-rotate")),qa(`[menu-button-id]:not([menu-button-id="${e}"]) > a`).forEach(t=>t.classList.remove("active")),q(".toggle-content:not(.hide)")?q(".app").classList.add("has-drawer"):q(".app").classList.remove("has-drawer")}else if(t.target.matches("#fav-apps .nav-item, #fav-apps .nav-item *")){let e=t.path.find(t=>t.classList&&t.classList.contains("nav-item")),n=e.getAttribute("app-name");e.classList.contains("app-active")?async function(t){await u,glue.appManager.application(t).instances.forEach(t=>t.activate())}(n):M(n)}var e}),document.addEventListener("click",t=>{if(t.target.matches(".close-drawer, .close-drawer *")){let e=t.path.find(t=>t&&t.getAttribute("menu-id")),n=e&&e.getAttribute("menu-id");n&&q(`[menu-button-id="${n}"]`).click()}}),async function(){let t;q("#fav-apps").addEventListener("mousewheel",t=>{q(".horizontal")&&(q("#fav-apps").scrollLeft+=Math.round(.8*t.deltaY),t.preventDefault())}),q(".app").addEventListener("mouseenter",e=>{q(".view-port").classList.add("expand"),q(".app").classList.add("expand-wrapper"),t&&clearTimeout(t)}),q(".app").addEventListener("mouseleave",e=>{let{offsetWidth:n,offsetHeight:a}=q(".view-port");e.x<n+50&&e.x>50&&e.y<a+50-6&&e.y>50&&console.error("fake leave"),qa(".toggle-content:not(.hide)").length>0||qa(".dropdown-menu.show").length>0||(t=setTimeout(()=>{q(".view-port").classList.remove("expand"),q(".app").classList.remove("expand-wrapper"),qa(".toggle-content").forEach(t=>t.classList.add("hide"))},500))})}(),document.addEventListener("click",t=>{t.target.matches('.modal [data-dismiss="modal"], .modal [data-dismiss="modal"] *')&&t.path.find(t=>t.classList.contains("modal")).classList.remove("show")})}function c(t){if(!t.propertyName||"width"!==t.propertyName)return;let e=t.srcElement;if(e.removeEventListener("transitionend",c),!e.classList.contains("hide")){let t=e.querySelector("input[autofocus]");t&&t.focus()}}const u=new Promise(async(t,e)=>{let n=await Glue({appManager:"full",layouts:"full"});window.glue=n,t(n)}),p=new rxjs.BehaviorSubject([]),d=new rxjs.BehaviorSubject([]),m=new rxjs.BehaviorSubject(null),h=new rxjs.BehaviorSubject(null),g=new rxjs.BehaviorSubject(null);window.glue42gd||(window.glue42gd={});window.glue42gd.user,window.glue42gd.version,window.glue42gd.gwURL;function f(){v(),glue.appManager.onAppAdded(v),glue.appManager.onAppRemoved(v),glue.appManager.onAppChanged(v),glue.appManager.onInstanceStarted(v),glue.appManager.onInstanceStopped(v)}function v(){p.next(glue.appManager.applications())}function w(){b(),glue.layouts.onAdded(b),glue.layouts.onRemoved(b),glue.layouts.onChanged(b),glue.layouts.onRenamed(b)}function b(){d.next(glue.layouts.list())}function y(){glue.agm.subscribe("T42.Notifications.Counter").then(t=>{t.onData(({data:t})=>{m.next(t.count)})})}function L(){glue.contexts.subscribe("Connect.Themes",t=>{console.log(t),h.next(t)})}function x(){glue.windows.my().onBoundsChanged(()=>{g.next(glue.windows.my().bounds)})}async function M(t){await u;let e=glue.appManager.application(t);if(!e)throw new Error(`Cannot find app with name "${t}"`);e.start()}u.then(t=>{f(),w(),y(),L(),x()});const E=new rxjs.BehaviorSubject([]);function j(){let t=E.value;document.querySelectorAll("#applications>li").forEach(e=>{let n=e.getAttribute("app-name");t.includes(n)?e.classList.add("fav-app"):e.classList.remove("fav-app")})}!function(){null===localStorage.getItem("favorite-apps")&&localStorage.setItem("favorite-apps","[]");let t=JSON.parse(localStorage.getItem("favorite-apps"));E.next(t)}();const S=new rxjs.BehaviorSubject("");let{filter:A,map:k,distinctUntilChanged:$,combineLatest:T}=rxjs.operators;const C=p.pipe(A(t=>t.length>0)).pipe($(void 0,t=>t.map(t=>t.title+t.instances.map(t=>t.id).join()).join()+JSON.stringify(o))).pipe(k(t=>t.filter(t=>function(t){let e=!0;s("showHiddenApps")||!t.hidden&&!t.autoStart||(e=!1);return e}(t)))).pipe(k(t=>t)).pipe(k(t=>t.sort(B))),O=C.pipe(T(S)).pipe(k(([t,e])=>{let n=e.toLowerCase().trim();return t.filter(t=>t.title.toLowerCase().indexOf(n)>=0)})),H=C.pipe(k(t=>t.filter(t=>t.instances.length>0)));function B(t,e){let n=t.userProperties.appManagerOrder,a=e.userProperties.appManagerOrder;return n&&!a?-1:!n&&a?1:n&&a?n-a:t.title.localeCompare(e.title)}function z(){q("#applications").addEventListener("click",t=>{let e=t.path.reduce((t,e)=>e.getAttribute&&e.getAttribute("app-name")?e.getAttribute("app-name"):t,"");if(t.target.matches(".add-favorite, .add-favorite *")){E.value.includes(e)?function(t){console.log("removing favorite app");let e=E.value.slice();e=e.filter(e=>e!==t),E.next(e),localStorage.setItem("favorite-apps",JSON.stringify(e)),j()}(e):function(t){console.log("adding app to favorite ",t);let e=E.value.slice();e.push(t),E.next(e),localStorage.setItem("favorite-apps",JSON.stringify(e)),j()}(e)}else{if(M(e),t.ctrlKey)return;S.next(""),q("#app-search").value=""}})}function N(t,e={}){let{favoriteBtn:n}=e;return`\n    <li class="nav-item ${t.instances.length>0?"app-active":""}"" app-name="${t.name}">\n      <div class="nav-link action-menu">\n        ${I(t)}\n        ${t.instances.length>0?'\x3c!--<span class="icon-size-24 active-app text-success"><i class="icon-dot mr-2 "></i></span>--\x3e':""}\n        <span class="title-app">${t.title||t.name}</span>`+(n?'\n        <div class="action-menu-tool">\n          <button class="btn btn-icon secondary add-favorite">\n          <i class="icon-star-empty-1" draggable="false"></i>\n          <i class="icon-star-full" draggable="false"></i>\n          </button>\n        </div>':"")+"</div>\n    </li>"}function I(t={}){return t.icon?`<img src="${t.icon}" draggable="false" style="width:16px;"/>`:'<span class="icon-size-16">\n    <i class="icon-app" draggable="false"></i>\n  </span>'}let P;function _(){q("#layout-load>ul").addEventListener("click",t=>{const e=t.path.find(t=>t.getAttribute&&t.getAttribute("layout-name"));if(!e)return;const n=e.getAttribute("layout-name"),a=e.getAttribute("layout-type");t.target.matches(".delete-layout, .delete-layout *")?(e.classList.add("show-actions"),e.classList.add("active")):t.target.matches(".layout-menu-tool, .layout-menu-tool *")?(t.target.matches(".layout-menu-tool .delete")&&async function(t,e){await u,glue.layouts.remove(t,e)}(a,n),e.classList.remove("show-actions"),e.classList.remove("active")):async function(t,e){await u,"Global"===t?glue.layouts.restore({name:e}):glue42gd.canvas.openWorkspace(e)}(a,n)})}function R(){var t;!async function(t){await u,glue.layouts.save({name:t})}((t=q("#layout-save-name").value,t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"))),q("#layout-save-name").value="",q("#layout-content").classList.add("hide"),q("#layout-load").classList.remove("hide")}!function(){let t=d.pipe(rxjs.operators.map(t=>t.map(t=>({name:t.name,type:t.type})).filter(t=>["Global","Swimlane"].includes(t.type))));const e=rxjs.fromEvent(q("#layout-search"),"keyup").pipe(rxjs.operators.map(t=>t.srcElement.value.toString().toLowerCase().trim())).pipe(rxjs.operators.distinctUntilChanged()).pipe(rxjs.operators.startWith(""));P=t.pipe(rxjs.operators.combineLatest(e)).pipe(rxjs.operators.map(([t,e])=>t.filter(t=>t.name.toLowerCase().includes(e))))}();let D,J=new rxjs.BehaviorSubject(!1),W=new rxjs.BehaviorSubject(!1);q(".layouts-nav").addEventListener("mouseenter",t=>{t.target.matches&&t.target.matches(".horizontal .layouts-nav, .horizontal .layouts-nav *")&&(console.log("layout ",!0),D=setTimeout(()=>{W.next(!0)},300))}),q(".layouts-nav").addEventListener("mouseleave",t=>{t.target.matches&&t.target.matches(".horizontal .layouts-nav, .horizontal .layouts-nav *")&&(W.next(!1),D&&clearInterval(D))});let G=new rxjs.BehaviorSubject({width:Math.round(q(".app").offsetWidth),height:Math.round(q(".app").offsetHeight),left:200,top:50});window.appBoundsObs=G,g.pipe(rxjs.operators.skip(2)).subscribe(t=>{q(".view-port").classList.add("expand"),q(".app").classList.add("expand-wrapper")}),g.pipe(rxjs.operators.filter(t=>t)).pipe(rxjs.operators.combineLatest(G)).subscribe(([t,e])=>{const n=glue42gd.monitors,a=q(".view-port").getBoundingClientRect();let o={left:t.left+a.left,top:t.top+a.top,height:a.height,width:a.width},i=(s=o,n.map(t=>{const{left:e,top:n,workingAreaWidth:a,workingAreaHeight:o}=t;return{monitor:t,totalOverlap:function(t,e){const n=t.left,a=t.top,o=n+t.width,i=a+t.height,s=e.left,l=e.top,r=s+e.width,c=l+e.height,u=Math.max(0,Math.min(o,r)-Math.max(n,s)),p=Math.max(0,Math.min(i,c)-Math.max(a,l));return u*p}({left:e,top:n,width:a,height:o},s)}}).sort((t,e)=>e.totalOverlap-t.totalOverlap)[0].monitor);var s;if(i&&!q(".app").classList.contains("has-drawer"))if(q(".view-port").classList.contains("horizontal")){let e=document.body.classList.contains("open-top"),n=t.top+t.height>i.workingAreaTop+i.workingAreaHeight;n?document.body.classList.add("open-top"):document.body.classList.remove("open-top"),e!==n&&G.next(!0)}else{let t=document.body.classList.contains("open-left"),e=o.left+500>i.left+i.width;e?document.body.classList.add("open-left"):document.body.classList.remove("open-left"),t!==e&&G.next(!0)}}),G.pipe(rxjs.operators.combineLatest(J,W)).subscribe(([t,e,n])=>{!function(t,e,n){let a=[];if(t=q(".app").getBoundingClientRect(),a.push({top:Math.round(t.top),left:Math.round(t.left),width:Math.round(t.width),height:Math.round(t.height)}),q(".view-port.horizontal")&&e){let{top:t,left:e,width:n,height:o}=q("#menu-top").getBoundingClientRect();t=Math.round(t),e=Math.round(e),n=Math.round(n),o=Math.round(o),a.push({top:t,left:e,width:n,height:o})}if(n){let{top:t,left:e,width:n,height:o}=q(".layout-menu-tool").getBoundingClientRect();t=Math.round(t),e=Math.round(e),n=Math.round(n),o=Math.round(o),a.push({top:t,left:e,width:n,height:o})}!async function(t){await u,window.glue.agm.invoke("T42.Wnd.Execute",{command:"updateVisibleAreas",windowId:glue.windows.my().id,options:{areas:t}})}(a)}(t,e,n)}),document.addEventListener("DOMContentLoaded",()=>{console.log("window loaded"),O.subscribe(t=>{let e="";t.length>0?(t.forEach(t=>e+=N(t,{favoriteBtn:!0})),q("#applications").innerHTML=e):q("#applications").innerHTML='<li class="text-center pt-3">No applications</li>',j()}),H.subscribe(t=>{let e="";t.length>0?(t.forEach(t=>e+=N(t,{favoriteBtn:!1})),q("#running-apps").innerHTML=e):q("#running-apps").innerHTML='<li class="text-center pt-3">No running applications</li><li class="text-center pt-3"><button class="btn btn-secondary" menu-button-id="apps">Start application</button></li>'}),P.subscribe(t=>{let e="";t.length>0?(t.forEach(t=>e+=function(t){return`\n  <li class="nav-item" layout-name="${t.name}" layout-type="${t.type}">\n    <div class="nav-link action-menu">\n      <i class="icon-03-context-viewer ml-2 mr-4"></i>\n      <span>${t.name}${"Swimlane"===t.type?" (Swimlane)":""}</span>\n      <div class="action-menu-tool delete-layout">\n        <button class="btn btn-icon secondary" id="menu-tool-4">\n          <i class="icon-trash-empty"></i>\n        </button>\n      </div>\n    </div>\n    <div class="layout-menu-tool">\n      <div class="delete">Delete</div>\n      <div class="cancel">Cancel</div>\n    </div>\n  </li>\n\n  `}(t)),q("#layout-load>ul").innerHTML=e):q("#layout-load>ul").innerHTML='<li class="text-center w-100 pt-3">No Layouts Saved</li><li class="text-center w-100 pt-3"><button class="btn btn-secondary" menu-button-id="layout-save">Add Layouts</button></li>'}),E.pipe(rxjs.operators.combineLatest(C)).subscribe(([t,e])=>{let n="",a=t.filter(t=>e.find(e=>e.name===t));a.length>0?a.forEach(t=>{let a=e.find(e=>e.name===t);var o;a&&(n+=(o=a)?`\n  <li class="nav-item ${o.instances.length>0?"app-active":""}" app-name="${o.name}">\n    <a class="nav-link" href="#" draggable="false" title="${o.title}">\n      ${I(o)}\n      <span class="text-animation">${o.title}</span>\n    </a>\n  </li>\n  `:"")}):n='<li class="text-center pt-3">No favorite apps</li>',q("#fav-apps").innerHTML=n}),m.subscribe(t=>{null!==t&&(q("#notifications-count").innerHTML=t,0===t?q("#notifications-count").classList.add("empty"):q("#notifications-count").classList.remove("empty"))}),new ResizeObserver(t=>{G.next(!0)}).observe(q(".app")),z(),q("#app-search").addEventListener("keyup",t=>{S.next(t.target.value)}),_(),q("#layout-save-btn").addEventListener("click",R),q("#layout-save-name").addEventListener("keyup",t=>"Enter"===t.key?R():null),document.addEventListener("click",t=>{if(t.target.matches("[dropdown-button-id], [dropdown-button-id] *")){let e=t.path.find(t=>t.getAttribute("dropdown-button-id")).getAttribute("dropdown-button-id"),n=q(`[dropdown-id="${e}"]`);n.classList.toggle("show"),J.next(n.classList.contains("show"))}else qa("[dropdown-id].show").forEach(t=>t.classList.remove("show")),J.next(!1)}),r(),function(){if(s("showTutorial"))try{M("getting-started")}catch(t){console.log("could not start Getting started app",t)}}(),async function(){await u,glue.hotkeys.register("Ctrl+Alt+T",()=>{glue.windows.my().focus()})}()})}]);